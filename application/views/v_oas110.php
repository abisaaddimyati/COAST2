<?php /************************************************************************************************ * Program History :** Project Name     : OAS* Client Name      : CBI - Muhammad* Program Id       : OAS110* Program Name     : Upload Document* Description      :* Environment      : PHP 5.4.4* Author           : Winni Oktaviani* Version          : 01.00.00* Creation Date    : 15-09-2015 00:02:00 ** Update history     Re-fix date       Person in charge      Description* * ** Copyright(C) [..]. All Rights Reserved*************************************************************************************************/?><div class="box-content no-padding">	<div class="box box-success">    <div class="box-body">  						<div class="form-group">                <label for="b_status" class="col-sm-3 control-label">Upload Document  </label>                <div class="input-group">						<form action='c_oas110/do_upload' method="post" enctype="multipart/form-data" id="MyUploadForm110">							<input name="FileInput110" id="FileInput110" type="file" />							<input type="hidden"  name="empid" value="<?=$this_name?>" />                            <input type="hidden" name="hd_DOC_ID"value="<?=$idDOC?>" >							<input type="submit"  id="submit-doc-110" value="Upload" />							<img src="images/ajax-loader.gif" id="loading-img110" style="display:none;" alt="Please Wait"/>						</form>						<div id="progressbox110" ><div id="progressbar110"></div ><div id="statustxt110">0%</div></div>						<div id="output110"></div>				</div>			</div>			<div class="form-group">				<label class="col-sm-3 control-label">Description</label>				<div class="input-group">									<textarea class="form-control" rows="5" cols="100" id="document_desc" rows="3"  input="textarea" ></textarea>				</div>			</div>        </div><!-- /.input-section -->    </div><!-- /.box-body -->	 <div class="box-footer clearfix">		<div class="pull-left" id="msg110"></div>        <button class="pull-right btn btn-primary" type="submit" id="btn_simpan110">SAVE</button>    </div></div><script type="text/javascript" src="assets/js/jquery-ui-1.10.3.min"></script><script type="text/javascript" src="assets/js/jquery.form.min.js"></script><script type="text/javascript">var employeeid = '<?= $this_id ?>';var doc_id = '<?= $idDOC ?>';var url 	= "<?php echo site_url('c_oas110/submit_doc'); ?>"$('#btn_simpan110').hide();var options = { 			target:   '#output110',   // target element(s) to be updated with server response 			beforeSubmit:  beforeSubmit,  // pre-submit callback 			success:       afterSuccess,  // post-submit callback 			uploadProgress: OnProgress, //upload progress callback 			resetForm: true        // reset the form after successful submit 		}; 			 $('#MyUploadForm110').submit(function() { 			$(this).ajaxSubmit(options);  						// always return false to prevent standard browser submit and page navigation 			return false; 		}); 		//function after succesful file upload (when server response)function afterSuccess(){	$('#loading-img110').hide(); //hide submit button	$('#progressbox110').delay( 1000 ).fadeOut(); //hide progress bar	$('#FileInput110').hide(); 	$('#submit-doc-110').hide(); //hide upload button	$('#btn_simpan110').show();}//function to check file size before uploading.function beforeSubmit(){    //check whether browser fully supports all File API   if (window.File && window.FileReader && window.FileList && window.Blob)	{				if( !$('#FileInput110').val()) //check empty input filed		{			$("#output110").html("Please choose file!");			return false;		}				var fsize = $('#FileInput110')[0].files[0].size; //get file size		var ftype = $('#FileInput110')[0].files[0].type; // get file type				//allow file types 		switch(ftype)        {            case 'image/png': 			case 'image/gif': 			case 'image/jpeg': 			case 'image/pjpeg':			case 'text/plain':			case 'text/html':			case 'application/x-zip-compressed':			case 'application/pdf':			case 'application/msword':			case 'application/vnd.ms-excel':			case 'video/mp4':                break;            default:                $("#output110").html("<b>"+ftype+"</b> Unsupported file type!");				return false;        }				//Allowed file size is less than 5 MB (1048576)		if(fsize>5242880) 		{			$("#output110").html("<b>"+bytesToSize(fsize) +"</b> Too big file! <br />File is too big, it should be less than 5 MB.");			return false;		}						$('#submit-doc-110').hide(); //hide submit button		$('#loading-img110').show(); //hide submit button		$("#output110").html("");  	}	else	{		//output110 error to older unsupported browsers that doesn't support HTML5 File API		$("#output110").html("Please upgrade your browser, because your current browser lacks some new features we need!");		return false;	}}//progress bar functionfunction OnProgress(event, position, total, percentComplete){    //Progress bar	$('#progressbox110').show();    $('#progressbar110').width(percentComplete + '%') //update progressbar110 percent complete    $('#statustxt110').html(percentComplete + '%'); //update status text    if(percentComplete>50)        {            $('#statustxt110').css('color','#000'); //change status text to white after 50%        }}//function to format bites bit.ly/19yoIPOfunction bytesToSize(bytes) {   var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];   if (bytes == 0) return '0 Bytes';   var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));   return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];}	// submit button	$('#btn_simpan110').on('click', function(){		var form_data = {			description		: $('#document_desc').val(),						doc_id			: doc_id		}; 		$.ajax({			url			: url, 			type		: 'POST',			async		: false,			data		: form_data,			timeout		: 1000, //1000ms			success: function(data) {				$('#msg110').html("<code><h5>Success !</h5></code>");				setTimeout(function(){					form_dialog_close();				}, 1000); 			},			error: function(){ 					alert("Failled");				$('#msg110').html("<p><code><h5>There was an error connecting to server. ! </h5></code></p>");            }		});    });</script>