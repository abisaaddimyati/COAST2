<?php /************************************************************************************************ * Program History :** Project Name     : OAS* Client Name      : CBI - Muhammad* Program Id       : OAS025* Program Name     : Detail Form Pengajuan Klaim* Description      :* Environment      : PHP 5.4.4* Author           : Winni Oktaviani* Version          : 01.00.00* Creation Date    : 01-10-2014 23:46:00 ICT 2014** Update history     Re-fix date       Person in charge    Description* 		1.00	      09-12-2014	    Winni Oktaviani		Finishing** Copyright(C) [..]. All Rights Reserved*************************************************************************************************/if (!defined('BASEPATH')) {exit('No direct script access allowed');}class M_OAS025 extends CI_Model {		function __construct() {		parent::__construct();		$this->user	= unserialize(base64_decode($this->session->userdata('user')));	}	function get_form_detail($form_id)	{		$sql = "SELECT 						cl.REF_NO no_ref,                        cl.KETERANGAN remark_requester,					    empl.EMPLOYEE_NAME employee_name,					    empl.EMPLOYEE_ID employee_id,					    usr.USER_EMAIL employee_email,					    ct.EXPENSE_TYPE_ID id,					    ct.EXPENSE_TYPE_NAME claim_type,                        ct.CLAIM_CATEGORY category_id,						cl.TANGGAL_KWITANSI tanggal_kwitansi,						cl.TOTAL total,						(select pos.VALUE from tb_m_system pos, tb_m_charge_code cc  where pos.SYS_CAT= '11' and cc.CHARGE_CODE = cl.CHARGE_CODE and pos.SYS_CD = cc.TYPE )  categorycc_name,					    (select cc.PROJECT_DESCRIPTION from tb_m_system pos, tb_m_charge_code cc  where pos.SYS_CAT= '11' and cc.CHARGE_CODE = cl.CHARGE_CODE and pos.SYS_CD = cc.TYPE )  cc_name,					    cl.CHARGE_CODE chargecode,						cl.CREATED_DT makerDate,						cl.CREATED_BY makerBy,					    sys.VALUE status,					    fs.STATUS status_id,						fs.REMARKS remark,                        fs.CREATED_BY app_by,                        fs.CREATED_DT app_dt,                        fs.UPDATED_BY fin_by,                        fs.UPDATED_DT fin_dt,						fs.APPROVEPUR_BY f2_by,						fs.APPROVEPUR_DT f2_dt,						fs.REMARKS_PUR f2_remark, 						fs.APPROVEDIR_BY dir_by,						fs.APPROVEDIR_DT dir_dt,						fs.REMARKS_DIR dir_remark,                        fs.TARGET_EMPLOYEE_ID target,                        (select app.EMPLOYEE_NAME from tb_m_employee app where app.EMPLOYEE_ID = fs.TARGET_EMPLOYEE_ID )  approve_name,					    cl.CLAIM_ID claim_id				    				FROM 						tb_r_form_status fs,						tb_m_employee empl,						tb_r_claim cl,					    tb_m_user usr,					    tb_m_expense_type ct,					    tb_m_system sys				WHERE					    cl.CLAIM_ID = '$form_id' AND					    cl.EMPLOYEE_ID = empl.EMPLOYEE_ID AND					    empl.EMPLOYEE_ID = usr.EMPLOYEE_ID AND					    cl.CLAIM_TYPE_ID = ct.EXPENSE_TYPE_ID AND					    sys.SYS_CAT = '9' AND					    sys.SYS_CD = fs.STATUS AND					    fs.FORM_ID = cl.CLAIM_ID AND					    fs.FORM_TYPE_ID = '5'";			return fetchArray($sql, 'row');	}function get_chargecode_div($form_id)	{			$sql = " SELECT 						cc.CHARGE_CODE 	ch,						cc.DIVISION_ID div_cc				    				FROM 						tb_m_charge_code cc,                        tb_r_claim cl				WHERE                        cl.CHARGE_CODE = cc.CHARGE_CODE AND					    cl.CLAIM_ID = '$form_id'";									return fetchArray($sql, 'row');	}		function get_form_remarks($form_id)	{		$sql = "SELECT 						fcl.REMARKS remark_fin,						fcl.CREATED_BY app_fin				FROM 						tb_r_form_confirmation_list fcl				WHERE					    fcl.FORM_TYPE_ID = '5' AND					    fcl.FORM_ID = '$form_id' ";			return fetchArray($sql, 'row');		}}